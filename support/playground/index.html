<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <title>Auth0 Lock Passwordless Playground üéÅ</title>

  <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/latest/lib/logos/img/favicon.png">
  <link rel="stylesheet" type="text/css" href="//cdn.auth0.com/styleguide/latest/index.css" />
  <script type="text/javascript" src="build/lock-passwordless.js"></script>
  <script type="text/javascript" src="assets/remember.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
  <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <style>
    .help-block {
      margin-bottom: 0;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>Auth0 Lock Passwordless Playground üéÅ</h1>
    <p>Make your e-mail or phone your password.</p>

    <div class="row">
      <div class="col-sm-8 col-xs-12">

        <form id="playground" class="form form-horizontal">
          <div class="form-group">
            <label class="col-xs-2 control-label">Mode</label>
            <div class="col-xs-4">
              <select name="method" class="form-control">
                <option value="sms" selected>SMS</option>
                <option value="magiclink">Magic Link</option>
                <option value="emailcode">Email Code</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="col-xs-2 control-label">clientID</label>
            <div class="col-xs-8">
              <input type="text" name="clientID" class="form-control" value="pmiDG0HgAJOKvcS8e5jaB0IjHL4ZtaKG" placeholder="YOUR_APP_CLIENT_ID">
            </div>
          </div>

          <div class="form-group">
            <label class="col-xs-2 control-label">domain</label>
            <div class="col-xs-8">
              <input type="text" name="domain" class="form-control" value="samples.auth0.com" placeholder="YOUR_DOMAIN.auth0.com">
            </div>
          </div>

          <ul class="nav nav-tabs" role="tablist">
             <li role="presentation" class="active"><a href="#ui-options" aria-controls="ui-options" role="tab" data-toggle="tab">UI Options</a></li>
             <li role="presentation"><a href="#auth-options" aria-controls="auth-options" role="tab" data-toggle="tab">Auth Options</a></li>
           </ul>

           <div class="tab-content">
             <div role="tabpanel" class="tab-pane active" id="ui-options">
              <p>The UI Options will help you customize the look and feel for your Passwordless Lock. Take a look at the <a href="https://github.com/auth0/lock-passwordless#ui-options" target="_blank">full spec</a> of options.</p>

              <div class="form-group">
                <label class="col-xs-2 control-label">container</label>
                <div class="col-xs-8">
                  <input type="text" name="container" class="form-control" placeholder="#container">
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">defaultLocation</label>
                <div class="col-xs-8">
                  <input type="text" name="defaultLocation" class="form-control" placeholder="US">
                  <p class="help-block"><a href="http://www.iso.org/iso/country_codes" target="_blank">ISO country code</a> for the region that will be selected by default</p>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">icon</label>
                <div class="col-xs-8">
                  <input type="text" name="icon" class="form-control" placeholder="https://domain.to/your-icon.png">
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">primaryColor</label>
                <div class="col-xs-8">
                  <input type="text" name="primaryColor" class="form-control" placeholder="#ea5323">
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">autoclose</label>
                <div class="col-xs-8">
                  <input type="checkbox" name="autoclose" checked>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">closable</label>
                <div class="col-xs-8">
                  <input type="checkbox" name="closable" checked>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">focusInput</label>
                <div class="col-xs-8">
                  <input type="checkbox" name="focusInput" checked>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">gravatar</label>
                <div class="col-xs-8">
                  <input type="checkbox" name="gravatar" checked>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">dict</label>
                <div class="col-xs-8">
                  <textarea name="dict" class="form-control" rows="3" placeholder='{"title": "hello"}'></textarea>
                  <p class="help-block">See the full <a href="https://github.com/auth0/lock-passwordless#dict-specification" target="_blank">Dict Specification</a> for more details</p>
                </div>
              </div>

            </div>
            <div role="tabpanel" class="tab-pane" id="auth-options">
              <p>The Authentication Options will allow you different ways of triggering the sign in and saving states for your user. Take a look at the <a href="https://github.com/auth0/lock-passwordless#authentication-options" target="_blank">full spec</a> of options.</p>

              <div class="form-group">
                <label class="col-xs-2 control-label">authParams</label>
                <div class="col-xs-8">
                  <textarea name="authParams" class="form-control" rows="3" placeholder='{"scope": "opendid profile"}'></textarea>
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">callbackURL</label>
                <div class="col-xs-8">
                  <input type="text" name="callbackURL" class="form-control" placeholder="http://myapp.com">
                </div>
              </div>

              <div class="form-group">
                <label class="col-xs-2 control-label">forceJSONP</label>
                <div class="col-xs-8">
                  <input type="checkbox" name="forceJSONP">
                </div>
              </div>

            </div>
          </div>

          <div class="form-group">
            <div class="col-xs-offset-2 col-xs-10">
              <button type="submit" class="btn btn-small btn-info">Open me!</button>
            </div>
          </div>

        </form>
      </div>

      <div class="col-sm-4 col-xs-12 well">
        <strong>#container</strong>
        <hr>
        <div id="container" style="min-height:400px;"></div>
      </div>

      <div class="col-sm-4 col-xs-12 well highlight">
        <strong>output</strong>
        <hr>
        <pre id="output" style="min-height:150px;">
      </pre>
    </div>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function(event) {
        var remember = require('remember');
        remember();
      });

      document.querySelector('form#playground').onsubmit = function (ev) {
        ev.preventDefault();

        var form = ev.target;
        var method = form.querySelector('[name="method"]').value;
        var clientID = form.querySelector('[name="clientID"]').value;
        var domain = form.querySelector('[name="domain"]').value;
        var lock = new Auth0LockPasswordless(clientID, domain);

        var options = {};

        // Strings
        options.icon = form.querySelector('[name="icon"]').value;
        options.container = (form.querySelector('[name="container"]').value || '').replace('#', '');
        options.defaultLocation = form.querySelector('[name="defaultLocation"]').value;
        options.primaryColor = form.querySelector('[name="primaryColor"]').value;
        options.callbackURL = form.querySelector('[name="callbackURL"]').value || undefined;

        // Booleans
        options.closable = !!form.querySelector('[name="closable"]').checked;
        options.focusInput = !!form.querySelector('[name="focusInput"]').checked;
        options.gravatar = !!form.querySelector('[name="gravatar"]').checked;
        options.forceJSONP = !!form.querySelector('[name="forceJSONP"]').checked;

        // Textareas + parsings
        try { options.dict = JSON.parse(form.querySelector('[name="dict"]').value); } catch (e) {}
        try { options.authParams = JSON.parse(form.querySelector('[name="authParams"]').value); } catch (e) {}

        // Exectue Lock with options
        lock[method](options, function (err, profile, id_token, access_token, state, refresh_token) {
          var outputContainer = $('#output');

          if (err) {
            outputContainer.text('Lock encountered an error:\n' + err.description);
            return;
          }

          if (method === 'magiclink') {
            outputContainer.text('Email sent to ' + profile);
          } else {
            outputContainer.text('{\n  access_token: "' + access_token + '",\n  id_token: "' + id_token + '"\n}');
          }
        });
      }
    </script>

  </div>
</body>
</html>
